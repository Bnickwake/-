# –®–∞–ª—ã–≥–∏–Ω –ù–∏–∫–∏—Ç–∞ –§–ü—ç-01-22


import numpy as np
import matplotlib.pyplot as plt
from iapws import IAPWS97 as gas
import os

MPa = 10 ** 6
kPa = 10 ** 3
unit = 1 / MPa
grad_Cels = 1
                  #–ó–∞–¥–∞—á–∞ 1
#–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –ø–∞—Ä–æ—Ç—É—Ä–±–∏–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞ –ø–∞—Ä–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø–∞—Ä–∞:
# ùëÉ0 = 5, 10, 15, 20 –ú–ü–∞. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–∑—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
# ùë°0= 300, 350, 400, 450, 500 –≥—Ä–∞–¥—É—Å–æ–≤ –¶–µ–ª—å—Å–∏—è,
# ùëÉùëò= 5 –∫–ü–∞. –ü—Ä–∏–Ω—è—Ç—å –¥–∞–≤–ª–µ–Ω–∏–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—É–ø–µ–Ω—å—é –ø–∞—Ä–æ–≤–æ–π —Ç—É—Ä–±–∏–Ω—ã
# ùëÉ2=ùëÉùëò. –¢–µ—Ä–º–∏—á–µ—Å–∫–∏–π –ö–ü–î —Ü–∏–∫–ª–∞ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –±–µ–∑ —É—á–µ—Ç–∞ –ø–æ–¥–æ–≥—Ä–µ–≤–∞ –≤–æ–¥—ã –≤ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–º –Ω–∞—Å–æ—Å–µ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.


def kpd(PO,TO,PK):
        point_0 = gas(P = PO * unit, T = (TO + 273.15))
        point_condenser_inlet = gas(P = (PK * unit) , s = point_0.s)
        point_pump_outlet = gas(P = (PK * unit), x = 0)
        useful_energy = point_0.h - point_condenser_inlet.h
        full_energy = point_0.h - point_pump_outlet.h
        kpd_value = (useful_energy / full_energy) * 100
        return kpd_value

#—Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ d–†–û,d–¢–û,–†–ö
def kpd(PO,TO,PK):
        point_0 = gas(P = PO * unit, T = (TO + 273.15))
        point_condenser_inlet = gas(P = (PK * unit) , s = point_0.s)
        point_pump_outlet = gas(P = (PK * unit), x = 0)
        useful_energy = point_0.h - point_condenser_inlet.h
        full_energy = point_0.h - point_pump_outlet.h
        kpd_value = (useful_energy / full_energy) * 100
        return kpd_value

#—Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ d–†–û,d–¢–û,–†–ö
def graf_term_kpd(PO,TO,PK):
    for p0 in PO:
        KPD = []
        for t0 in TO:
            kpd_value = kpd(p0, t0, PK)
            KPD.append(kpd_value)
        plt.xlabel("t0, –≥—Ä–∞–¥—É—Å—ã –¶–µ–ª—å—Å–∏—è")
        plt.ylabel("–¢–µ—Ä–º–∏—á–µ—Å–∫–∏–π –ö–ü–î, %")
        plt.title("–ì—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –æ—Ç to")
        plt.plot(TO,KPD, label = f"–ü—Ä–∏ P0 = {p0 * unit} –ú–ü–∞")
    plt.grid()
    plt.legend()
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ —Ä–∞–±–æ—á–µ–º—É —Å—Ç–æ–ª—É
    desktop_path = os.path.join(os.path.expanduser("~"), "Desktop")

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ "–≤ –≥–∏—Ç—Ö–∞–±", —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–æ—è –ø–∞–ø–∫–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
    folder_name = "–≤ –≥–∏—Ç—Ö–∞–±"
    folder_path = os.path.join(desktop_path, folder_name)

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞ "–≤ –≥–∏—Ç—Ö–∞–±"
    if not os.path.exists(folder_path):
        os.makedirs(folder_path)

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
    file_path = os.path.join(folder_path, 'dz1graf1.png')

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ (—ç—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ñ–∞–π–ª, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    plt.savefig(file_path)
    return plt.show()

if __name__ == "__main__":
    #–¥–∞–Ω–æ
    p0 = np.array([5 * MPa, 10 * MPa, 15 * MPa, 20 * MPa]) # –ú–µ–≥–∞ –ü–∞—Å–∫–∞–ª—å
    t0 = np.array([300, 350, 400, 450 ,500]) # –ì—Ä–∞–¥—É—Å –¶–µ–ª—å—Å–∏—è
    pk = 5 * kPa


#–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é
grafik1 = graf_term_kpd(p0,t0,pk)



                # –ó–∞–¥–∞—á–∞ 2
# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –ø–∞—Ä–æ—Ç—É—Ä–±–∏–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞ –ø–∞—Ä–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø–∞—Ä–∞:
# ùëÉ0= 5 –ú–ü–∞,
# ùë°0= 450 –≥—Ä–∞–¥—É—Å–æ–≤ –¶–µ–ª—å—Å–∏—è,
# ùëÉùëò= 5, 10, 15, 20, 50 –∫–ü–∞. –ü—Ä–∏–Ω—è—Ç—å –¥–∞–≤–ª–µ–Ω–∏–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—É–ø–µ–Ω—å—é –ø–∞—Ä–æ–≤–æ–π —Ç—É—Ä–±–∏–Ω—ã
# ùëÉ2= ùëÉùëò. –¢–µ—Ä–º–∏—á–µ—Å–∫–∏–π –ö–ü–î —Ü–∏–∫–ª–∞ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –±–µ–∑ —É—á–µ—Ç–∞ –ø–æ–¥–æ–≥—Ä–µ–≤–∞ –≤–æ–¥—ã –≤ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–º –Ω–∞—Å–æ—Å–µ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.


#—Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –†–û,–¢–û,d–†–ö
def graf_pk(PO,TO,PK):
    # 1) KPD- –º–∞—Å—Å–∏–≤ –ö–ü–î
    KPD = []
    for PK1 in pk:
        kpd_value = kpd(PO, TO, PK1)
        KPD.append(kpd_value)
    plt.xlabel("Pk, –ü–∞")
    plt.ylabel("–¢–µ—Ä–º–∏—á–µ—Å–∫–∏–π –ö–ü–î, %")
    plt.title("–ì—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏—á–µ—Å–∫–æ–≥–æ –ö–ü–î –æ—Ç Pk")
    plt.plot(PK,KPD, label = f"–ü—Ä–∏ P0 = {PO * unit} (–ú–ü–∞) –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ t0= {TO} (–≥—Ä–∞–¥—É—Å –¶–µ–ª—å—Å–∏—è)")
    plt.grid()
    plt.legend( loc='upper left')

    desktop_path = os.path.join(os.path.expanduser("~"), "Desktop")

    folder_name = "–≥—Ä–∞—Ñ–∏–∫–∏ –®–∞–ª—ã–≥–∏–Ω"
    folder_path = os.path.join(desktop_path, folder_name)

    if not os.path.exists(folder_path):
        os.makedirs(folder_path)

    file_path = os.path.join(folder_path, 'dz1graf2.png')

    plt.savefig(file_path)
    return plt.show()

if __name__ == "__main__":
# –ó–Ω–∞—á–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è –∏ —Ç–µ–º–ø—Ä–∞—Ç—É—Ä—ã
    p0 = 5 * MPa  #–º–µ–≥–∞ –ø–∞—Å–∫–∞–ª—å
    t0 = 450 #–≥—Ä–∞–¥—É—Å—ã —Ü–µ–ª—å—Å–∏—è
    pk = np.array([5 * kPa, 10 * kPa, 15 * kPa, 20 * kPa, 50 * kPa]) # –ö–∏–ª–æ –ü–∞—Å–∫–∞–ª—å
  
#–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é
graf22 = graf_pk(p0,t0,pk)


